<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galactic Todo - Star Wars</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Exo+2:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Exo 2', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0f;
            min-height: 100vh;
            color: #e0e0e0;
            overflow-x: hidden;
        }

        /* Ïö∞Ï£º Î∞∞Í≤Ω + Î≥Ñ */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .stars::before,
        .stars::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .stars::before {
            background-image:
                radial-gradient(2px 2px at 20px 30px, #fff, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(2px 2px at 130px 80px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 160px 120px, #fff, transparent),
                radial-gradient(2px 2px at 200px 50px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 250px 160px, #fff, transparent),
                radial-gradient(2px 2px at 300px 100px, rgba(255,255,255,0.5), transparent),
                radial-gradient(1px 1px at 350px 200px, #fff, transparent),
                radial-gradient(2px 2px at 400px 150px, rgba(255,255,255,0.8), transparent);
            background-size: 400px 300px;
            animation: twinkle 4s infinite;
        }

        .stars::after {
            background-image:
                radial-gradient(1px 1px at 50px 100px, #4fd1ff, transparent),
                radial-gradient(2px 2px at 100px 200px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 150px 50px, #ffe81f, transparent),
                radial-gradient(2px 2px at 200px 180px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 280px 90px, #4fd1ff, transparent),
                radial-gradient(2px 2px at 320px 250px, rgba(255,255,255,0.5), transparent),
                radial-gradient(1px 1px at 380px 130px, #fff, transparent);
            background-size: 500px 350px;
            animation: twinkle 6s infinite reverse;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Îã§Ïä§Î≤†Ïù¥Îçî Ïã§Î£®Ïó£ (CSSÎ°ú Ï†úÏûë) */
        .vader {
            position: fixed;
            bottom: 0;
            right: 20px;
            z-index: 0;
            pointer-events: none;
            opacity: 0.35;
            transform: scale(0.8);
        }

        /* Î≤†Ïù¥Îçî Ìó¨Î©ß */
        .vader-helmet {
            width: 120px;
            height: 140px;
            background: #0a0a0a;
            border-radius: 60px 60px 40px 40px;
            position: relative;
            margin: 0 auto;
        }

        /* Ìó¨Î©ß ÏÉÅÎã® Îèî */
        .vader-helmet::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 40px;
            background: #0a0a0a;
            border-radius: 40px 40px 0 0;
        }

        /* ÎßàÏä§ÌÅ¨ ÎîîÌÖåÏùº */
        .vader-mask {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 60px;
        }

        /* Îàà Î∂ÄÎ∂Ñ */
        .vader-eyes {
            display: flex;
            justify-content: space-between;
            padding: 0 5px;
        }

        .vader-eye {
            width: 30px;
            height: 15px;
            background: #1a1a1a;
            border: 2px solid #2a2a2a;
            border-radius: 0 0 15px 15px;
            box-shadow: inset 0 0 10px rgba(255,0,0,0.3);
        }

        /* Ìò∏Ìù°Í∏∞ */
        .vader-breather {
            width: 40px;
            height: 30px;
            background: #0a0a0a;
            margin: 15px auto 0;
            border-radius: 5px;
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            padding: 5px;
            justify-content: center;
        }

        .vader-breather span {
            width: 8px;
            height: 4px;
            background: #1a1a1a;
            border-radius: 2px;
        }

        /* Î™∏Ï≤¥ */
        .vader-body {
            width: 200px;
            height: 300px;
            background: linear-gradient(180deg, #0a0a0a 0%, #050505 100%);
            margin: -10px auto 0;
            border-radius: 10px 10px 0 0;
            position: relative;
        }

        /* Í∞ÄÏä¥ Ìå®ÎÑê */
        .vader-chest {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 80px;
            background: #1a1a1a;
            border: 2px solid #2a2a2a;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 10px 5px;
        }

        .vader-chest-light {
            width: 100%;
            height: 8px;
            border-radius: 2px;
        }

        .vader-chest-light:nth-child(1) { background: #ff0000; box-shadow: 0 0 10px #ff0000; }
        .vader-chest-light:nth-child(2) { background: #00ff00; box-shadow: 0 0 10px #00ff00; }
        .vader-chest-light:nth-child(3) { background: #0088ff; box-shadow: 0 0 10px #0088ff; }
        .vader-chest-light:nth-child(4) { background: #ff0000; box-shadow: 0 0 10px #ff0000; }

        /* Î†àÎìú ÎùºÏù¥Ìä∏ÏÑ∏Ïù¥Î≤Ñ */
        .lightsaber-red {
            position: fixed;
            bottom: 80px;
            right: 200px;
            width: 6px;
            height: 180px;
            background: linear-gradient(180deg,
                rgba(255,0,0,0.6) 0%,
                rgba(255,50,50,0.4) 60%,
                rgba(255,100,100,0.2) 85%,
                transparent 100%);
            border-radius: 4px;
            box-shadow:
                0 0 15px rgba(255,0,0,0.5),
                0 0 30px rgba(255,0,0,0.3);
            transform: rotate(20deg) scale(0.8);
            animation: saberGlow 2s ease-in-out infinite;
            z-index: 0;
            opacity: 0.5;
        }

        /* ÎùºÏù¥Ìä∏ÏÑ∏Ïù¥Î≤Ñ ÏÜêÏû°Ïù¥ */
        .lightsaber-red::after {
            content: '';
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            width: 14px;
            height: 40px;
            background: linear-gradient(90deg, #2a2a2a, #4a4a4a, #2a2a2a);
            border-radius: 3px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        @keyframes saberGlow {
            0%, 100% { opacity: 0.9; filter: brightness(1); }
            50% { opacity: 1; filter: brightness(1.2); }
        }

        /* Î≤†Ïù¥Îçî Ïà®Ïâ¨Í∏∞ Ïï†ÎãàÎ©îÏù¥ÏÖò */
        .vader {
            animation: vaderBreathe 4s ease-in-out infinite;
        }

        @keyframes vaderBreathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.01); }
        }

        /* ÏãúÎÑ§ÎßàÌã± ÎπÑÎÑ§Ìä∏ Ìö®Í≥º */
        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            background: radial-gradient(ellipse at center,
                transparent 0%,
                transparent 50%,
                rgba(0,0,0,0.4) 100%);
        }

        /* Î∂âÏùÄ Í≤ΩÍ≥†Îì± Ìö®Í≥º (Ï†úÍµ≠ ÎäêÎÇå) */
        .imperial-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            background: radial-gradient(ellipse at bottom right,
                rgba(255, 0, 0, 0.03) 0%,
                transparent 50%);
            animation: imperialPulse 4s ease-in-out infinite;
        }

        @keyframes imperialPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            position: relative;
            z-index: 1;
        }

        /* Ìó§Îçî */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 232, 31, 0.2);
        }

        .header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(180deg, #ffe81f 0%, #ffa500 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(255, 232, 31, 0.5);
            letter-spacing: 2px;
        }

        /* ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò */
        .tabs {
            display: flex;
            gap: 8px;
        }

        .tab {
            padding: 10px 20px;
            background: rgba(20, 30, 50, 0.8);
            border: 1px solid rgba(79, 209, 255, 0.3);
            border-radius: 8px;
            color: #8899aa;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        .tab:hover {
            background: rgba(30, 50, 80, 0.9);
            color: #4fd1ff;
            border-color: rgba(79, 209, 255, 0.5);
        }

        .tab.active {
            background: linear-gradient(135deg, rgba(79, 209, 255, 0.2) 0%, rgba(79, 209, 255, 0.1) 100%);
            border-color: #4fd1ff;
            color: #4fd1ff;
            box-shadow: 0 0 20px rgba(79, 209, 255, 0.3), inset 0 0 20px rgba(79, 209, 255, 0.1);
        }

        /* Î©îÏù∏ Î†àÏù¥ÏïÑÏõÉ */
        .main {
            display: grid;
            grid-template-columns: 360px 1fr;
            gap: 24px;
        }

        @media (max-width: 900px) {
            .main {
                grid-template-columns: 1fr;
            }
        }

        /* Îã¨Î†• */
        .calendar-section {
            background: rgba(10, 18, 35, 0.97);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(79, 209, 255, 0.3);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.7), inset 0 0 30px rgba(79, 209, 255, 0.05);
            backdrop-filter: blur(10px);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            font-weight: 600;
            color: #ffe81f;
            letter-spacing: 1px;
        }

        .calendar-nav {
            display: flex;
            gap: 8px;
        }

        .calendar-nav button {
            width: 36px;
            height: 36px;
            background: rgba(79, 209, 255, 0.1);
            border: 1px solid rgba(79, 209, 255, 0.3);
            border-radius: 8px;
            color: #4fd1ff;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
        }

        .calendar-nav button:hover {
            background: rgba(79, 209, 255, 0.2);
            box-shadow: 0 0 15px rgba(79, 209, 255, 0.3);
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-bottom: 8px;
        }

        .weekday {
            text-align: center;
            font-size: 11px;
            color: #ffe81f;
            padding: 8px 0;
            font-weight: 600;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(20, 35, 60, 0.8);
            border: 1px solid rgba(79, 209, 255, 0.15);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            font-size: 14px;
            font-weight: 600;
            color: #d0e0f0;
        }

        .calendar-day:hover {
            background: rgba(79, 209, 255, 0.15);
            border-color: rgba(79, 209, 255, 0.4);
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(79, 209, 255, 0.2);
        }

        .calendar-day.other-month {
            color: #3a4a5a;
            background: rgba(10, 15, 25, 0.4);
        }

        .calendar-day.today {
            border-color: #ffe81f;
            background: rgba(255, 232, 31, 0.1);
            color: #ffe81f;
            box-shadow: 0 0 15px rgba(255, 232, 31, 0.2);
        }

        .calendar-day.selected {
            background: linear-gradient(135deg, rgba(79, 209, 255, 0.3) 0%, rgba(79, 209, 255, 0.15) 100%);
            border-color: #4fd1ff;
            color: #4fd1ff;
            box-shadow: 0 0 20px rgba(79, 209, 255, 0.4), inset 0 0 15px rgba(79, 209, 255, 0.1);
        }

        .calendar-day .dot {
            position: absolute;
            bottom: 5px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ff00;
            box-shadow: 0 0 8px #00ff00;
        }

        .calendar-day .dot.incomplete {
            background: #ff6b35;
            box-shadow: 0 0 8px #ff6b35;
        }

        .calendar-day.selected .dot {
            background: #4fd1ff;
            box-shadow: 0 0 8px #4fd1ff;
        }

        /* ÌÜµÍ≥Ñ ÎØ∏Îãà */
        .stats-mini {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(79, 209, 255, 0.15);
        }

        .stat-mini {
            text-align: center;
            padding: 12px;
            background: rgba(79, 209, 255, 0.05);
            border: 1px solid rgba(79, 209, 255, 0.1);
            border-radius: 8px;
        }

        .stat-mini-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 22px;
            font-weight: 700;
            color: #4fd1ff;
            text-shadow: 0 0 10px rgba(79, 209, 255, 0.5);
        }

        .stat-mini-label {
            font-size: 10px;
            color: #8899aa;
            margin-top: 4px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Ìï†Ïùº ÏÑπÏÖò */
        .todo-section {
            background: rgba(10, 18, 35, 0.97);
            border-radius: 16px;
            padding: 28px;
            border: 1px solid rgba(79, 209, 255, 0.3);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.7), inset 0 0 30px rgba(79, 209, 255, 0.05);
            backdrop-filter: blur(10px);
        }

        .todo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .todo-date {
            font-family: 'Orbitron', sans-serif;
            font-size: 20px;
            font-weight: 600;
            color: #e0e0e0;
        }

        .todo-date span {
            color: #ffe81f;
            font-weight: 500;
            font-size: 12px;
            margin-left: 10px;
            background: rgba(255, 232, 31, 0.15);
            padding: 4px 12px;
            border-radius: 20px;
            border: 1px solid rgba(255, 232, 31, 0.3);
        }

        /* ÏûÖÎ†• Ìèº */
        .input-form {
            background: rgba(15, 28, 50, 0.9);
            border: 1px solid rgba(79, 209, 255, 0.25);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .input-row {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }

        .input-row:last-child {
            margin-bottom: 0;
        }

        .input-form input[type="text"] {
            flex: 1;
            padding: 14px 18px;
            background: rgba(20, 35, 60, 0.8);
            border: 2px solid rgba(79, 209, 255, 0.3);
            border-radius: 10px;
            color: #e0e0e0;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.3s;
        }

        .input-form input[type="text"]::placeholder {
            color: #5a6a7a;
        }

        .input-form input[type="text"]:focus {
            outline: none;
            border-color: #4fd1ff;
            background: rgba(25, 45, 75, 0.9);
            box-shadow: 0 0 20px rgba(79, 209, 255, 0.2);
        }

        .input-form input[type="time"] {
            padding: 14px 18px;
            background: rgba(20, 35, 60, 0.8);
            border: 2px solid rgba(79, 209, 255, 0.3);
            border-radius: 10px;
            color: #e0e0e0;
            font-size: 14px;
            font-family: inherit;
            color-scheme: dark;
        }

        .input-form select {
            padding: 14px 18px;
            background: rgba(15, 25, 45, 0.95);
            border: 2px solid rgba(79, 209, 255, 0.4);
            border-radius: 10px;
            color: #ffffff;
            font-size: 14px;
            font-family: inherit;
            cursor: pointer;
            min-width: 120px;
        }

        .input-form select option {
            background: #0f1932;
            color: #ffffff;
            padding: 10px;
        }

        .input-form select:focus {
            outline: none;
            border-color: #4fd1ff;
            box-shadow: 0 0 15px rgba(79, 209, 255, 0.3);
        }

        .input-form button {
            padding: 14px 28px;
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            border: none;
            border-radius: 10px;
            color: #000;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
        }

        .input-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.6);
        }

        /* ÌÉÄÏûÖ Î±ÉÏßÄ */
        .type-badge {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            margin-right: 10px;
        }

        .type-badge.todo {
            background: rgba(79, 209, 255, 0.2);
            color: #4fd1ff;
            border: 1px solid rgba(79, 209, 255, 0.4);
        }

        .type-badge.schedule {
            background: rgba(255, 232, 31, 0.2);
            color: #ffe81f;
            border: 1px solid rgba(255, 232, 31, 0.4);
        }

        .type-badge.meeting {
            background: rgba(255, 100, 255, 0.2);
            color: #ff64ff;
            border: 1px solid rgba(255, 100, 255, 0.4);
        }

        /* Ï§ëÏöîÎèÑ ÌëúÏãú */
        .priority-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .priority-dot.high {
            background: #ff3232;
            box-shadow: 0 0 10px #ff3232;
        }

        .priority-dot.normal {
            background: #ffaa00;
            box-shadow: 0 0 10px #ffaa00;
        }

        .priority-dot.low {
            background: #00cc00;
            box-shadow: 0 0 10px #00cc00;
        }

        /* ÏãúÍ∞Ñ ÌëúÏãú */
        .todo-time {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            color: #4fd1ff;
            margin-right: 12px;
            min-width: 50px;
        }

        /* Ïπ¥ÌÖåÍ≥†Î¶¨ ÌëúÏãú */
        .category-tag {
            padding: 3px 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            font-size: 10px;
            color: #8899aa;
            margin-left: 10px;
        }

        /* Ìï†Ïùº ÏïÑÏù¥ÌÖú ÏóÖÎç∞Ïù¥Ìä∏ */
        .todo-content {
            flex: 1;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 6px;
        }

        /* Ìï†Ïùº Î¶¨Ïä§Ìä∏ */
        .todo-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 420px;
            overflow-y: auto;
        }

        .todo-list::-webkit-scrollbar {
            width: 6px;
        }

        .todo-list::-webkit-scrollbar-track {
            background: rgba(79, 209, 255, 0.05);
            border-radius: 3px;
        }

        .todo-list::-webkit-scrollbar-thumb {
            background: rgba(79, 209, 255, 0.3);
            border-radius: 3px;
        }

        .todo-item {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            background: rgba(20, 35, 60, 0.6);
            border: 1px solid rgba(79, 209, 255, 0.15);
            border-radius: 10px;
            transition: all 0.3s;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .todo-item:hover {
            background: rgba(30, 50, 80, 0.7);
            border-color: rgba(79, 209, 255, 0.3);
            transform: translateX(4px);
            box-shadow: 0 0 15px rgba(79, 209, 255, 0.1);
        }

        .todo-item.completed {
            opacity: 0.5;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #5a6a7a;
        }

        .todo-checkbox {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid rgba(79, 209, 255, 0.4);
            border-radius: 6px;
            margin-right: 14px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            flex-shrink: 0;
            background: rgba(79, 209, 255, 0.05);
        }

        .todo-checkbox:hover {
            border-color: #4fd1ff;
            box-shadow: 0 0 10px rgba(79, 209, 255, 0.3);
        }

        .todo-checkbox:checked {
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            border-color: #00ff00;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }

        .todo-checkbox:checked::after {
            content: '';
            position: absolute;
            left: 7px;
            top: 3px;
            width: 6px;
            height: 11px;
            border: solid #000;
            border-width: 0 2.5px 2.5px 0;
            transform: rotate(45deg);
        }

        .todo-text {
            flex: 1;
            font-size: 15px;
            color: #e8f0f8;
            font-weight: 500;
        }

        .todo-actions {
            display: flex;
            gap: 6px;
            opacity: 0;
            transition: all 0.3s;
        }

        .todo-item:hover .todo-actions {
            opacity: 1;
        }

        .todo-btn {
            padding: 8px 14px;
            background: rgba(79, 209, 255, 0.1);
            border: 1px solid rgba(79, 209, 255, 0.3);
            border-radius: 6px;
            color: #6a8a9a;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .todo-btn.move:hover {
            background: rgba(79, 209, 255, 0.2);
            border-color: #4fd1ff;
            color: #4fd1ff;
            box-shadow: 0 0 10px rgba(79, 209, 255, 0.3);
        }

        .todo-btn.delete:hover {
            background: rgba(255, 50, 50, 0.2);
            border-color: #ff3232;
            color: #ff3232;
            box-shadow: 0 0 10px rgba(255, 50, 50, 0.3);
        }

        /* ÎÇ†Ïßú Ïù¥Îèô Î™®Îã¨ */
        .move-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .move-modal.active {
            display: flex;
        }

        .move-modal-content {
            background: rgba(15, 25, 45, 0.98);
            border: 1px solid rgba(79, 209, 255, 0.3);
            border-radius: 16px;
            padding: 28px;
            width: 90%;
            max-width: 360px;
            box-shadow: 0 0 60px rgba(79, 209, 255, 0.2);
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .move-modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            font-weight: 600;
            color: #ffe81f;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .move-modal-todo {
            font-size: 14px;
            color: #8899aa;
            margin-bottom: 20px;
            padding: 12px;
            background: rgba(79, 209, 255, 0.05);
            border: 1px solid rgba(79, 209, 255, 0.15);
            border-radius: 8px;
        }

        .move-modal-input {
            width: 100%;
            padding: 14px 16px;
            background: rgba(20, 35, 60, 0.8);
            border: 2px solid rgba(79, 209, 255, 0.3);
            border-radius: 8px;
            font-size: 15px;
            font-family: inherit;
            margin-bottom: 20px;
            transition: all 0.3s;
            color: #e0e0e0;
            color-scheme: dark;
        }

        .move-modal-input:focus {
            outline: none;
            border-color: #4fd1ff;
            box-shadow: 0 0 15px rgba(79, 209, 255, 0.2);
        }

        .move-modal-buttons {
            display: flex;
            gap: 12px;
        }

        .move-modal-btn {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .move-modal-btn.cancel {
            background: rgba(100, 100, 120, 0.3);
            border: 1px solid rgba(150, 150, 170, 0.3);
            color: #8899aa;
        }

        .move-modal-btn.cancel:hover {
            background: rgba(100, 100, 120, 0.5);
            color: #c0c0c0;
        }

        .move-modal-btn.confirm {
            background: linear-gradient(135deg, #4fd1ff 0%, #00a8e8 100%);
            color: #000;
            box-shadow: 0 0 20px rgba(79, 209, 255, 0.4);
        }

        .move-modal-btn.confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(79, 209, 255, 0.6);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #5a6a7a;
        }

        .empty-state::before {
            content: 'üöÄ';
            display: block;
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* ÌÜµÍ≥Ñ ÌéòÏù¥ÏßÄ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .stats-card {
            background: rgba(15, 25, 45, 0.9);
            border: 1px solid rgba(79, 209, 255, 0.2);
            border-radius: 16px;
            padding: 28px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }

        .stats-card-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 40px;
            font-weight: 700;
            color: #4fd1ff;
            text-shadow: 0 0 20px rgba(79, 209, 255, 0.5);
        }

        .stats-card-label {
            font-size: 12px;
            color: #8899aa;
            margin-top: 8px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .chart-section {
            background: rgba(15, 25, 45, 0.9);
            border: 1px solid rgba(79, 209, 255, 0.2);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }

        .chart-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 24px;
            color: #ffe81f;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            gap: 12px;
            height: 160px;
            padding: 0 10px;
        }

        .chart-bar-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .chart-bar {
            width: 100%;
            max-width: 50px;
            background: linear-gradient(180deg, #4fd1ff 0%, #00a8e8 100%);
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
            min-height: 4px;
            box-shadow: 0 0 15px rgba(79, 209, 255, 0.4);
        }

        .chart-bar-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            color: #8899aa;
            font-weight: 500;
        }

        .insights {
            background: rgba(15, 25, 45, 0.9);
            border: 1px solid rgba(79, 209, 255, 0.2);
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }

        .insight-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 0;
            border-bottom: 1px solid rgba(79, 209, 255, 0.1);
        }

        .insight-item:last-child {
            border-bottom: none;
        }

        .insight-icon {
            font-size: 24px;
        }

        .insight-text {
            font-size: 14px;
            color: #a0b0c0;
            font-weight: 450;
        }

        /* ÌéòÏù¥ÏßÄ Ï†ÑÌôò */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* ÏÑ§Ï†ï ÌéòÏù¥ÏßÄ */
        .settings-section {
            background: rgba(15, 25, 45, 0.9);
            border: 1px solid rgba(79, 209, 255, 0.2);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }

        .settings-section.danger {
            border-color: rgba(255, 50, 50, 0.4);
        }

        .settings-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: #ffe81f;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .settings-desc {
            font-size: 14px;
            color: #8899aa;
            margin-bottom: 20px;
        }

        .settings-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .settings-btn {
            padding: 14px 24px;
            background: linear-gradient(135deg, #4fd1ff 0%, #00a8e8 100%);
            border: none;
            border-radius: 8px;
            color: #000;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 0 20px rgba(79, 209, 255, 0.4);
        }

        .settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(79, 209, 255, 0.6);
        }

        .settings-btn.reset {
            background: linear-gradient(135deg, #ff3232 0%, #ff5555 100%);
            box-shadow: 0 0 20px rgba(255, 50, 50, 0.4);
        }

        .settings-btn.reset:hover {
            box-shadow: 0 0 30px rgba(255, 50, 50, 0.6);
        }

        .settings-list {
            padding-left: 20px;
            color: #a0b0c0;
            font-size: 14px;
            line-height: 2;
        }

        .settings-list strong {
            color: #4fd1ff;
        }

        /* Î°úÍ∑∏Ïù∏/Ïú†Ï†Ä ÏòÅÏó≠ */
        .user-area {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .login-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
        }

        .login-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: #4fd1ff;
            color: #4fd1ff;
        }

        .login-btn img {
            width: 18px;
            height: 18px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid #4fd1ff;
            box-shadow: 0 0 10px rgba(79, 209, 255, 0.3);
        }

        .user-name {
            font-size: 12px;
            color: #a0b0c0;
            font-family: 'Orbitron', sans-serif;
        }

        .logout-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid rgba(255, 50, 50, 0.4);
            border-radius: 6px;
            color: #ff6666;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
        }

        .logout-btn:hover {
            background: rgba(255, 50, 50, 0.2);
            border-color: #ff3232;
        }

        .sync-status {
            font-size: 10px;
            color: #00ff00;
            font-family: 'Orbitron', sans-serif;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .sync-status.offline {
            color: #ff6b35;
        }

        .sync-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ff00;
            box-shadow: 0 0 8px #00ff00;
            animation: pulse 2s infinite;
        }

        .sync-status.offline .sync-dot {
            background: #ff6b35;
            box-shadow: 0 0 8px #ff6b35;
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }
            .header-right {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Ïä§ÌÉÄÏõåÏ¶à ÏãúÎÑ§ÎßàÌã± Î∞∞Í≤Ω -->
    <div class="stars"></div>
    <div class="vignette"></div>
    <div class="imperial-glow"></div>
    <div class="lightsaber-red"></div>
    <div class="vader">
        <div class="vader-helmet">
            <div class="vader-mask">
                <div class="vader-eyes">
                    <div class="vader-eye"></div>
                    <div class="vader-eye"></div>
                </div>
                <div class="vader-breather">
                    <span></span><span></span><span></span>
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
        <div class="vader-body">
            <div class="vader-chest">
                <div class="vader-chest-light"></div>
                <div class="vader-chest-light"></div>
                <div class="vader-chest-light"></div>
                <div class="vader-chest-light"></div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <h1>GALACTIC TODO</h1>
                <div class="tabs">
                    <button class="tab active" data-tab="main">MISSIONS</button>
                    <button class="tab" data-tab="stats">ANALYTICS</button>
                    <button class="tab" data-tab="settings">CONTROL</button>
                </div>
            </div>
            <div class="header-right">
                <div id="syncStatus" class="sync-status offline">
                    <span class="sync-dot"></span>
                    <span>LOCAL MODE</span>
                </div>
                <div id="userArea" class="user-area">
                    <button class="login-btn" onclick="googleLogin()">
                        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                        CONNECT
                    </button>
                </div>
            </div>
        </div>

        <!-- Î©îÏù∏ ÌéòÏù¥ÏßÄ -->
        <div class="page active" id="main-page">
            <div class="main">
                <!-- Îã¨Î†• -->
                <div class="calendar-section">
                    <div class="calendar-header">
                        <span class="calendar-title" id="calendarTitle"></span>
                        <div class="calendar-nav">
                            <button onclick="changeMonth(-1)">‚Äπ</button>
                            <button onclick="changeMonth(1)">‚Ä∫</button>
                        </div>
                    </div>
                    <div class="calendar-weekdays">
                        <div class="weekday">Ïùº</div>
                        <div class="weekday">Ïõî</div>
                        <div class="weekday">Ìôî</div>
                        <div class="weekday">Ïàò</div>
                        <div class="weekday">Î™©</div>
                        <div class="weekday">Í∏à</div>
                        <div class="weekday">ÌÜ†</div>
                    </div>
                    <div class="calendar-days" id="calendarDays"></div>

                    <div class="stats-mini">
                        <div class="stat-mini">
                            <div class="stat-mini-value" id="monthTotal">0</div>
                            <div class="stat-mini-label">Ïù¥Î≤à Îã¨ Ìï†Ïùº</div>
                        </div>
                        <div class="stat-mini">
                            <div class="stat-mini-value" id="monthCompleted">0</div>
                            <div class="stat-mini-label">ÏôÑÎ£å</div>
                        </div>
                        <div class="stat-mini">
                            <div class="stat-mini-value" id="monthRate">0%</div>
                            <div class="stat-mini-label">Îã¨ÏÑ±Î•†</div>
                        </div>
                    </div>
                </div>

                <!-- Ìï†Ïùº -->
                <div class="todo-section">
                    <div class="todo-header">
                        <div class="todo-date">
                            <span id="selectedDateTitle"></span>
                            <span id="selectedDateSub"></span>
                        </div>
                    </div>

                    <div class="input-form">
                        <div class="input-row">
                            <input type="text" id="todoInput" placeholder="Enter your mission..." onkeypress="handleKeyPress(event)">
                        </div>
                        <div class="input-row">
                            <select id="todoType">
                                <option value="todo">üìã Ìï†Ïùº</option>
                                <option value="schedule">üìÖ ÏùºÏ†ï</option>
                                <option value="meeting">üë• ÎØ∏ÌåÖ</option>
                            </select>
                            <input type="time" id="todoTime">
                            <select id="todoPriority">
                                <option value="normal">üü° Î≥¥ÌÜµ</option>
                                <option value="high">üî¥ Ï§ëÏöî</option>
                                <option value="low">üü¢ ÎÇÆÏùå</option>
                            </select>
                            <select id="todoCategory">
                                <option value="">Ïπ¥ÌÖåÍ≥†Î¶¨</option>
                                <option value="work">ÏóÖÎ¨¥</option>
                                <option value="personal">Í∞úÏù∏</option>
                                <option value="health">Í±¥Í∞ï</option>
                                <option value="study">Í≥µÎ∂Ä</option>
                            </select>
                            <button onclick="addTodo()">DEPLOY</button>
                        </div>
                    </div>

                    <div class="todo-list" id="todoList"></div>
                </div>
            </div>
        </div>

        <!-- ÌÜµÍ≥Ñ ÌéòÏù¥ÏßÄ -->
        <div class="page" id="stats-page">
            <div class="stats-grid">
                <div class="stats-card">
                    <div class="stats-card-value" id="totalTodos">0</div>
                    <div class="stats-card-label">Ï†ÑÏ≤¥ Ìï†Ïùº</div>
                </div>
                <div class="stats-card">
                    <div class="stats-card-value" id="totalCompleted">0</div>
                    <div class="stats-card-label">ÏôÑÎ£åÌïú Ìï†Ïùº</div>
                </div>
                <div class="stats-card">
                    <div class="stats-card-value" id="totalRate">0%</div>
                    <div class="stats-card-label">Ï†ÑÏ≤¥ Îã¨ÏÑ±Î•†</div>
                </div>
                <div class="stats-card">
                    <div class="stats-card-value" id="streakDays">0</div>
                    <div class="stats-card-label">Ïó∞ÏÜç Îã¨ÏÑ±Ïùº</div>
                </div>
            </div>

            <div class="chart-section">
                <div class="chart-title">ÏµúÍ∑º 7Ïùº Îã¨ÏÑ±Î•†</div>
                <div class="chart-bars" id="weeklyChart"></div>
            </div>

            <div class="insights">
                <div class="chart-title">Î∂ÑÏÑù</div>
                <div id="insightsList"></div>
            </div>
        </div>

        <!-- ÎÇ†Ïßú Ïù¥Îèô Î™®Îã¨ -->
        <div class="move-modal" id="moveModal" onclick="closeMoveModal(event)">
            <div class="move-modal-content" onclick="event.stopPropagation()">
                <div class="move-modal-title">ÎÇ†Ïßú Ïù¥Îèô</div>
                <div class="move-modal-todo" id="moveModalTodo"></div>
                <input type="date" class="move-modal-input" id="moveModalDate">
                <div class="move-modal-buttons">
                    <button class="move-modal-btn cancel" onclick="closeMoveModal()">Ï∑®ÏÜå</button>
                    <button class="move-modal-btn confirm" onclick="confirmMoveTodo()">Ïù¥Îèô</button>
                </div>
            </div>
        </div>

        <!-- ÏÑ§Ï†ï ÌéòÏù¥ÏßÄ -->
        <div class="page" id="settings-page">
            <div class="settings-section">
                <h2 class="settings-title">Îç∞Ïù¥ÌÑ∞ Î∞±ÏóÖ</h2>
                <p class="settings-desc">Îç∞Ïù¥ÌÑ∞Î•º JSON ÌååÏùºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í±∞ÎÇò Í∞ÄÏ†∏Ïò¨ Ïàò ÏûàÏñ¥Ïöî.</p>
                <div class="settings-buttons">
                    <button class="settings-btn" onclick="exportData()">üì§ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                    <button class="settings-btn" onclick="document.getElementById('importFile').click()">üì• Í∞ÄÏ†∏Ïò§Í∏∞</button>
                    <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
                </div>
            </div>

            <div class="settings-section">
                <h2 class="settings-title">ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî Î∞©Î≤ï</h2>
                <p class="settings-desc">OneDriveÎÇò Google DriveÏóêÏÑú ÎèôÍ∏∞ÌôîÌïòÎ†§Î©¥:</p>
                <ol class="settings-list">
                    <li>ÏúÑÏóêÏÑú Îç∞Ïù¥ÌÑ∞Î•º <strong>ÎÇ¥Î≥¥ÎÇ¥Í∏∞</strong></li>
                    <li>ÌÅ¥ÎùºÏö∞Îìú Ìè¥ÎçîÏóê JSON ÌååÏùº Ï†ÄÏû•</li>
                    <li>Îã§Î•∏ PCÏóêÏÑú Ìï¥Îãπ ÌååÏùºÏùÑ <strong>Í∞ÄÏ†∏Ïò§Í∏∞</strong></li>
                </ol>
            </div>

            <div class="settings-section danger">
                <h2 class="settings-title">Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî</h2>
                <p class="settings-desc">Î™®Îì† Ìï†Ïùº Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌï©ÎãàÎã§.</p>
                <button class="settings-btn reset" onclick="resetData()">üóëÔ∏è Ï†ÑÏ≤¥ ÏÇ≠Ï†ú</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // ÏÑ§Ï†ï
        // ============================================

        // 1. ÌóàÏö©Ìï† Ïù¥Î©îÏùº (Î≥∏Ïù∏ Gmail Ï£ºÏÜå)
        const ALLOWED_EMAIL = "fisherpark@gmail.com";

        // 2. Firebase ÏÑ§Ï†ï
        const firebaseConfig = {
            apiKey: "AIzaSyBExygT3fT8Ah3ohruhJmORCXwH4h601VM",
            authDomain: "galactic-todo.firebaseapp.com",
            databaseURL: "https://galactic-todo-default-rtdb.firebaseio.com",
            projectId: "galactic-todo",
            storageBucket: "galactic-todo.firebasestorage.app",
            messagingSenderId: "706561556446",
            appId: "1:706561556446:web:811010c40377502a0c674f"
        };

        // Firebase Ï¥àÍ∏∞Ìôî
        let db = null;
        let currentUser = null;
        let dbRef = null;

        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.database();
        } catch (e) {
            console.log('Firebase ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
        }

        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå
        let todos = JSON.parse(localStorage.getItem('todos')) || {};
        let currentDate = new Date();
        let selectedDate = new Date();

        // Google Î°úÍ∑∏Ïù∏
        async function googleLogin() {
            if (!db) {
                alert('Firebase ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.\n\nÏÑ§Ï†ï Î∞©Î≤ï:\n1. Firebase ConsoleÏóêÏÑú ÌîÑÎ°úÏ†ùÌä∏ ÏÉùÏÑ±\n2. AuthenticationÏóêÏÑú Google Î°úÍ∑∏Ïù∏ ÌôúÏÑ±Ìôî\n3. Realtime Database ÏÉùÏÑ±\n4. ÏÑ§Ï†ï Ï†ïÎ≥¥Î•º ÏΩîÎìúÏóê ÏûÖÎ†•');
                return;
            }
            try {
                console.log('Î°úÍ∑∏Ïù∏ ÏãúÎèÑ Ï§ë...');
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.setCustomParameters({
                    prompt: 'select_account'
                });
                const result = await firebase.auth().signInWithPopup(provider);
                console.log('Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ:', result.user.email);
            } catch (error) {
                console.error('Î°úÍ∑∏Ïù∏ ÏóêÎü¨:', error);
                let errorMsg = 'Î°úÍ∑∏Ïù∏Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\n\n';

                if (error.code === 'auth/popup-blocked') {
                    errorMsg += 'ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏóàÏäµÎãàÎã§.\nÌåùÏóÖ Ï∞®Îã®ÏùÑ Ìï¥Ï†úÌï¥Ï£ºÏÑ∏Ïöî.';
                } else if (error.code === 'auth/popup-closed-by-user') {
                    errorMsg += 'Î°úÍ∑∏Ïù∏ Ï∞ΩÏù¥ Îã´ÌòîÏäµÎãàÎã§.\nÎã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                } else if (error.code === 'auth/unauthorized-domain') {
                    errorMsg += 'Ïù¥ ÎèÑÎ©îÏù∏Ïù¥ FirebaseÏóêÏÑú ÏäπÏù∏ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.\n\nFirebase Console > Authentication > Settings > Authorized domainsÏóêÏÑú\nÌòÑÏû¨ ÎèÑÎ©îÏù∏ÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.\n\nÌòÑÏû¨ ÎèÑÎ©îÏù∏: ' + window.location.hostname;
                } else if (error.code === 'auth/network-request-failed') {
                    errorMsg += 'ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•òÏûÖÎãàÎã§.\nÏù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
                } else {
                    errorMsg += error.message + '\n\nÏóêÎü¨ ÏΩîÎìú: ' + error.code;
                }

                alert(errorMsg);
            }
        }

        // Î°úÍ∑∏ÏïÑÏõÉ
        async function logout() {
            try {
                await firebase.auth().signOut();
            } catch (error) {
                console.error('Î°úÍ∑∏ÏïÑÏõÉ ÏóêÎü¨:', error);
            }
        }

        // Ïù∏Ï¶ù ÏÉÅÌÉú Î≥ÄÍ≤Ω Í∞êÏßÄ
        if (db) {
            firebase.auth().onAuthStateChanged(async (user) => {
                console.log('Ïù∏Ï¶ù ÏÉÅÌÉú Î≥ÄÍ≤Ω:', user ? user.email : 'Î°úÍ∑∏ÏïÑÏõÉ');

                // Ïù¥Î©îÏùº Ï≤¥ÌÅ¨ - ÌóàÏö©Îêú Í≥ÑÏ†ïÎßå ÏÇ¨Ïö© Í∞ÄÎä•
                if (user && user.email !== ALLOWED_EMAIL) {
                    console.log('Í∂åÌïú ÏóÜÎäî ÏÇ¨Ïö©Ïûê:', user.email);
                    alert('Ï†ëÍ∑º Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§.\n\nÎ°úÍ∑∏Ïù∏Ìïú Í≥ÑÏ†ï: ' + user.email + '\nÌóàÏö©Îêú Í≥ÑÏ†ï: ' + ALLOWED_EMAIL + '\n\nÎã§Î•∏ Í≥ÑÏ†ïÏúºÎ°ú Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                    await firebase.auth().signOut();
                    return;
                }

                currentUser = user;
                updateUserUI();

                if (user) {
                    console.log('Î°úÍ∑∏Ïù∏ ÏôÑÎ£å, ÎèôÍ∏∞Ìôî ÏãúÏûë:', user.email);
                    // DB Ï∞∏Ï°∞ ÏÑ§Ï†ï
                    dbRef = db.ref('users/' + user.uid + '/todos');
                    // Ïã§ÏãúÍ∞Ñ ÎèôÍ∏∞Ìôî ÏãúÏûë
                    startRealtimeSync();
                } else {
                    console.log('Î°úÍ∑∏ÏïÑÏõÉÎê®, Î°úÏª¨ Î™®ÎìúÎ°ú Ï†ÑÌôò');
                    // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                    if (dbRef) {
                        dbRef.off();
                        dbRef = null;
                    }
                    todos = JSON.parse(localStorage.getItem('todos')) || {};
                    renderCalendar();
                    renderTodos();
                }
            });
        }

        // UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateUserUI() {
            const userArea = document.getElementById('userArea');
            const syncStatus = document.getElementById('syncStatus');

            if (currentUser) {
                userArea.innerHTML = `
                    <div class="user-info">
                        <img src="${currentUser.photoURL || ''}" class="user-avatar" alt="User">
                        <span class="user-name">${currentUser.displayName || 'Pilot'}</span>
                    </div>
                    <button class="logout-btn" onclick="logout()">DISCONNECT</button>
                `;
                syncStatus.className = 'sync-status';
                syncStatus.innerHTML = '<span class="sync-dot"></span><span>SYNCED</span>';
            } else {
                userArea.innerHTML = `
                    <button class="login-btn" onclick="googleLogin()">
                        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                        CONNECT
                    </button>
                `;
                syncStatus.className = 'sync-status offline';
                syncStatus.innerHTML = '<span class="sync-dot"></span><span>LOCAL MODE</span>';
            }
        }

        // ÌÅ¥ÎùºÏö∞ÎìúÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        async function saveToCloud() {
            if (!currentUser || !dbRef) return;

            try {
                await dbRef.set(todos);
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• ÏóêÎü¨:', error);
            }
        }

        // Ïã§ÏãúÍ∞Ñ ÎèôÍ∏∞Ìôî
        function startRealtimeSync() {
            if (!currentUser || !dbRef) return;

            dbRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    todos = data;
                } else {
                    // ÌÅ¥ÎùºÏö∞ÎìúÏóê Îç∞Ïù¥ÌÑ∞ ÏóÜÏúºÎ©¥ Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏóÖÎ°úÎìú
                    saveToCloud();
                }
                localStorage.setItem('todos', JSON.stringify(todos));
                renderCalendar();
                renderTodos();
            });
        }

        // ÎÇ†Ïßú Ìè¨Îß∑
        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        function formatDateKR(date) {
            const days = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            return `${date.getMonth() + 1}Ïõî ${date.getDate()}Ïùº ${days[date.getDay()]}ÏöîÏùº`;
        }

        // Ï†ÄÏû• (Î°úÏª¨ + ÌÅ¥ÎùºÏö∞Îìú)
        function saveTodos() {
            localStorage.setItem('todos', JSON.stringify(todos));
            if (currentUser && db) {
                saveToCloud();
            }
        }

        // Îã¨Î†• Î†åÎçîÎßÅ
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            document.getElementById('calendarTitle').textContent = `${year}ÎÖÑ ${month + 1}Ïõî`;

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDay = firstDay.getDay();
            const totalDays = lastDay.getDate();

            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';

            // Ïù¥Ï†Ñ Îã¨ ÎÇ†Ïßú
            const prevMonthLastDay = new Date(year, month, 0).getDate();
            for (let i = startDay - 1; i >= 0; i--) {
                const day = prevMonthLastDay - i;
                const div = document.createElement('div');
                div.className = 'calendar-day other-month';
                div.textContent = day;
                calendarDays.appendChild(div);
            }

            // Ïù¥Î≤à Îã¨ ÎÇ†Ïßú
            const today = new Date();
            for (let day = 1; day <= totalDays; day++) {
                const date = new Date(year, month, day);
                const dateStr = formatDate(date);
                const div = document.createElement('div');
                div.className = 'calendar-day';
                div.textContent = day;

                if (date.toDateString() === today.toDateString()) {
                    div.classList.add('today');
                }

                if (date.toDateString() === selectedDate.toDateString()) {
                    div.classList.add('selected');
                }

                // Ìï†Ïùº ÌëúÏãú
                const dayTodos = todos[dateStr] || [];
                if (dayTodos.length > 0) {
                    const dot = document.createElement('div');
                    dot.className = 'dot';
                    const allCompleted = dayTodos.every(t => t.completed);
                    if (!allCompleted) dot.classList.add('incomplete');
                    div.appendChild(dot);
                }

                div.onclick = () => selectDate(date);
                calendarDays.appendChild(div);
            }

            // Îã§Ïùå Îã¨ ÎÇ†Ïßú
            const remainingDays = 42 - (startDay + totalDays);
            for (let day = 1; day <= remainingDays; day++) {
                const div = document.createElement('div');
                div.className = 'calendar-day other-month';
                div.textContent = day;
                calendarDays.appendChild(div);
            }

            updateMonthStats();
        }

        // ÎÇ†Ïßú ÏÑ†ÌÉù
        function selectDate(date) {
            selectedDate = date;
            renderCalendar();
            renderTodos();
        }

        // Ïõî Î≥ÄÍ≤Ω
        function changeMonth(delta) {
            currentDate.setMonth(currentDate.getMonth() + delta);
            renderCalendar();
        }

        // Ìï†Ïùº Î†åÎçîÎßÅ
        function renderTodos() {
            const dateStr = formatDate(selectedDate);
            const dayTodos = todos[dateStr] || [];

            document.getElementById('selectedDateTitle').textContent = formatDateKR(selectedDate);

            const today = new Date();
            if (selectedDate.toDateString() === today.toDateString()) {
                document.getElementById('selectedDateSub').textContent = 'Ïò§Îäò';
            } else {
                const diff = Math.ceil((selectedDate - today) / (1000 * 60 * 60 * 24));
                if (diff > 0) {
                    document.getElementById('selectedDateSub').textContent = `${diff}Ïùº ÌõÑ`;
                } else if (diff < 0) {
                    document.getElementById('selectedDateSub').textContent = `${Math.abs(diff)}Ïùº Ï†Ñ`;
                } else {
                    document.getElementById('selectedDateSub').textContent = '';
                }
            }

            const todoList = document.getElementById('todoList');

            if (dayTodos.length === 0) {
                todoList.innerHTML = '<div class="empty-state">No missions assigned<br>May the Force guide your new task</div>';
                return;
            }

            const typeLabels = { todo: 'Ìï†Ïùº', schedule: 'ÏùºÏ†ï', meeting: 'ÎØ∏ÌåÖ' };
            const categoryLabels = { work: 'ÏóÖÎ¨¥', personal: 'Í∞úÏù∏', health: 'Í±¥Í∞ï', study: 'Í≥µÎ∂Ä' };

            todoList.innerHTML = dayTodos.map((todo, index) => `
                <div class="todo-item ${todo.completed ? 'completed' : ''}">
                    <span class="priority-dot ${todo.priority || 'normal'}"></span>
                    <input type="checkbox" class="todo-checkbox"
                           ${todo.completed ? 'checked' : ''}
                           onchange="toggleTodo(${index})">
                    <div class="todo-content">
                        ${todo.time ? `<span class="todo-time">${todo.time}</span>` : ''}
                        <span class="type-badge ${todo.type || 'todo'}">${typeLabels[todo.type] || 'Ìï†Ïùº'}</span>
                        <span class="todo-text">${escapeHtml(todo.text)}</span>
                        ${todo.category ? `<span class="category-tag">${categoryLabels[todo.category] || todo.category}</span>` : ''}
                    </div>
                    <div class="todo-actions">
                        <button class="todo-btn move" onclick="openMoveModal(${index})">Ïù¥Îèô</button>
                        <button class="todo-btn delete" onclick="deleteTodo(${index})">ÏÇ≠Ï†ú</button>
                    </div>
                </div>
            `).join('');
        }

        // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Ìï†Ïùº Ï∂îÍ∞Ä
        function addTodo() {
            const input = document.getElementById('todoInput');
            const text = input.value.trim();
            if (!text) return;

            const type = document.getElementById('todoType').value;
            const time = document.getElementById('todoTime').value;
            const priority = document.getElementById('todoPriority').value;
            const category = document.getElementById('todoCategory').value;

            const dateStr = formatDate(selectedDate);
            if (!todos[dateStr]) todos[dateStr] = [];

            todos[dateStr].push({
                text,
                type,
                time,
                priority,
                category,
                completed: false,
                createdAt: new Date().toISOString()
            });

            // ÏãúÍ∞ÑÏàú Ï†ïÎ†¨ (ÏãúÍ∞Ñ ÏûàÎäî Í≤É Î®ºÏ†Ä, Í∑∏ Îã§Ïùå Ï§ëÏöîÎèÑ)
            todos[dateStr].sort((a, b) => {
                // ÏãúÍ∞Ñ ÏûàÎäî Í≤É Î®ºÏ†Ä
                if (a.time && !b.time) return -1;
                if (!a.time && b.time) return 1;
                if (a.time && b.time) return a.time.localeCompare(b.time);
                // Ï§ëÏöîÎèÑ Ïàú
                const priorityOrder = { high: 0, normal: 1, low: 2 };
                return (priorityOrder[a.priority] || 1) - (priorityOrder[b.priority] || 1);
            });

            saveTodos();
            renderTodos();
            renderCalendar();
            input.value = '';
            document.getElementById('todoTime').value = '';
            input.focus();
        }

        function handleKeyPress(e) {
            if (e.key === 'Enter') addTodo();
        }

        // Ìï†Ïùº ÌÜ†Í∏Ä
        function toggleTodo(index) {
            const dateStr = formatDate(selectedDate);
            todos[dateStr][index].completed = !todos[dateStr][index].completed;
            if (todos[dateStr][index].completed) {
                todos[dateStr][index].completedAt = new Date().toISOString();
            }
            saveTodos();
            renderTodos();
            renderCalendar();
        }

        // Ìï†Ïùº ÏÇ≠Ï†ú
        function deleteTodo(index) {
            const dateStr = formatDate(selectedDate);
            todos[dateStr].splice(index, 1);
            if (todos[dateStr].length === 0) delete todos[dateStr];
            saveTodos();
            renderTodos();
            renderCalendar();
        }

        // ÏõîÎ≥Ñ ÌÜµÍ≥Ñ
        function updateMonthStats() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            let total = 0;
            let completed = 0;

            Object.keys(todos).forEach(dateStr => {
                const date = new Date(dateStr);
                if (date.getFullYear() === year && date.getMonth() === month) {
                    todos[dateStr].forEach(todo => {
                        total++;
                        if (todo.completed) completed++;
                    });
                }
            });

            document.getElementById('monthTotal').textContent = total;
            document.getElementById('monthCompleted').textContent = completed;
            document.getElementById('monthRate').textContent = total > 0 ? Math.round(completed / total * 100) + '%' : '0%';
        }

        // ÌÜµÍ≥Ñ ÌéòÏù¥ÏßÄ
        function renderStats() {
            let total = 0;
            let completed = 0;

            Object.values(todos).forEach(dayTodos => {
                dayTodos.forEach(todo => {
                    total++;
                    if (todo.completed) completed++;
                });
            });

            document.getElementById('totalTodos').textContent = total;
            document.getElementById('totalCompleted').textContent = completed;
            document.getElementById('totalRate').textContent = total > 0 ? Math.round(completed / total * 100) + '%' : '0%';

            // Ïó∞ÏÜç Îã¨ÏÑ±Ïùº Í≥ÑÏÇ∞
            let streak = 0;
            const today = new Date();
            for (let i = 0; i < 365; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = formatDate(date);
                const dayTodos = todos[dateStr] || [];

                if (dayTodos.length === 0) {
                    if (i === 0) continue;
                    break;
                }

                const allCompleted = dayTodos.every(t => t.completed);
                if (allCompleted) {
                    streak++;
                } else {
                    break;
                }
            }
            document.getElementById('streakDays').textContent = streak;

            renderWeeklyChart();
            renderInsights();
        }

        function renderWeeklyChart() {
            const chart = document.getElementById('weeklyChart');
            const days = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            const today = new Date();

            let html = '';
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = formatDate(date);
                const dayTodos = todos[dateStr] || [];

                let rate = 0;
                if (dayTodos.length > 0) {
                    const completed = dayTodos.filter(t => t.completed).length;
                    rate = Math.round(completed / dayTodos.length * 100);
                }

                html += `
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: ${Math.max(rate, 4)}%"></div>
                        <div class="chart-bar-label">${days[date.getDay()]}</div>
                    </div>
                `;
            }
            chart.innerHTML = html;
        }

        function renderInsights() {
            const insights = [];
            const days = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];

            const dayStats = [0, 0, 0, 0, 0, 0, 0].map(() => ({ total: 0, completed: 0 }));

            Object.keys(todos).forEach(dateStr => {
                const date = new Date(dateStr);
                const day = date.getDay();
                todos[dateStr].forEach(todo => {
                    dayStats[day].total++;
                    if (todo.completed) dayStats[day].completed++;
                });
            });

            let worstDay = -1;
            let worstRate = 101;
            let bestDay = -1;
            let bestRate = -1;

            dayStats.forEach((stat, day) => {
                if (stat.total >= 3) {
                    const rate = stat.completed / stat.total * 100;
                    if (rate < worstRate) {
                        worstRate = rate;
                        worstDay = day;
                    }
                    if (rate > bestRate) {
                        bestRate = rate;
                        bestDay = day;
                    }
                }
            });

            if (bestDay >= 0) {
                insights.push({
                    icon: 'üèÜ',
                    text: `${days[bestDay]}ÏöîÏùº Îã¨ÏÑ±Î•†Ïù¥ Í∞ÄÏû• ÎÜíÏïÑÏöî (${Math.round(bestRate)}%)`
                });
            }

            if (worstDay >= 0 && worstRate < 70) {
                insights.push({
                    icon: 'üí™',
                    text: `${days[worstDay]}ÏöîÏùº Îã¨ÏÑ±Î•†ÏùÑ ÎÜíÏó¨Î≥¥ÏÑ∏Ïöî (${Math.round(worstRate)}%)`
                });
            }

            let total = 0;
            let completed = 0;
            Object.values(todos).forEach(dayTodos => {
                dayTodos.forEach(todo => {
                    total++;
                    if (todo.completed) completed++;
                });
            });

            if (total > 0) {
                const rate = completed / total * 100;
                if (rate >= 80) {
                    insights.push({ icon: 'üéâ', text: 'ÌõåÎ•≠Ìï¥Ïöî! Ï†ÑÏ≤¥ Îã¨ÏÑ±Î•†Ïù¥ 80% Ïù¥ÏÉÅÏûÖÎãàÎã§' });
                } else if (rate >= 50) {
                    insights.push({ icon: 'üëç', text: 'ÏûòÌïòÍ≥† ÏûàÏñ¥Ïöî! Ï°∞Í∏àÎßå Îçî ÎÖ∏Î†•Ìï¥Î≥¥ÏÑ∏Ïöî' });
                } else {
                    insights.push({ icon: 'üî•', text: 'Ìï† ÏùºÏùÑ ÏûëÍ≤å ÎÇòÎà†ÏÑú ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî' });
                }
            }

            if (insights.length === 0) {
                insights.push({ icon: 'üìä', text: 'Îç∞Ïù¥ÌÑ∞Í∞Ä ÏåìÏù¥Î©¥ Î∂ÑÏÑù Í≤∞Í≥ºÎ•º Î≥º Ïàò ÏûàÏñ¥Ïöî' });
            }

            document.getElementById('insightsList').innerHTML = insights.map(i => `
                <div class="insight-item">
                    <span class="insight-icon">${i.icon}</span>
                    <span class="insight-text">${i.text}</span>
                </div>
            `).join('');
        }

        // ÌÉ≠ Ï†ÑÌôò
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));

                tab.classList.add('active');
                document.getElementById(tab.dataset.tab + '-page').classList.add('active');

                if (tab.dataset.tab === 'stats') {
                    renderStats();
                }
            });
        });

        // Ìï†Ïùº Ïù¥Îèô Í¥ÄÎ†®
        let movingTodoIndex = null;

        function openMoveModal(index) {
            const dateStr = formatDate(selectedDate);
            const todo = todos[dateStr][index];
            movingTodoIndex = index;

            document.getElementById('moveModalTodo').textContent = todo.text;
            document.getElementById('moveModalDate').value = dateStr;
            document.getElementById('moveModal').classList.add('active');
        }

        function closeMoveModal(event) {
            if (event && event.target !== document.getElementById('moveModal')) return;
            document.getElementById('moveModal').classList.remove('active');
            movingTodoIndex = null;
        }

        function confirmMoveTodo() {
            const newDateStr = document.getElementById('moveModalDate').value;
            const oldDateStr = formatDate(selectedDate);

            if (!newDateStr) {
                alert('ÎÇ†ÏßúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (newDateStr === oldDateStr) {
                alert('Í∞ôÏùÄ ÎÇ†ÏßúÏûÖÎãàÎã§. Îã§Î•∏ ÎÇ†ÏßúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            const todo = todos[oldDateStr][movingTodoIndex];

            // Í∏∞Ï°¥ ÎÇ†ÏßúÏóêÏÑú ÏÇ≠Ï†ú
            todos[oldDateStr].splice(movingTodoIndex, 1);
            if (todos[oldDateStr].length === 0) delete todos[oldDateStr];

            // ÏÉà ÎÇ†ÏßúÏóê Ï∂îÍ∞Ä
            if (!todos[newDateStr]) todos[newDateStr] = [];
            todos[newDateStr].unshift(todo);

            saveTodos();
            closeMoveModal();
            renderCalendar();
            renderTodos();

            const newDate = new Date(newDateStr);
            alert(`${newDate.getMonth() + 1}Ïõî ${newDate.getDate()}ÏùºÎ°ú Ïù¥ÎèôÌñàÏäµÎãàÎã§.`);
        }

        // Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
        function exportData() {
            const data = {
                todos: todos,
                exportedAt: new Date().toISOString(),
                version: '1.0'
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `todo-backup-${formatDate(new Date())}.json`;
            a.click();
            URL.revokeObjectURL(url);
            alert('Î∞±ÏóÖ ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
        }

        // Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.todos) {
                        if (confirm('Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò® Îç∞Ïù¥ÌÑ∞Î°ú ÍµêÏ≤¥Ìï†ÍπåÏöî?')) {
                            todos = data.todos;
                            saveTodos();
                            renderCalendar();
                            renderTodos();
                            alert('Îç∞Ïù¥ÌÑ∞Î•º ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§!');
                        }
                    } else {
                        alert('Ïò¨Î∞îÎ•∏ Î∞±ÏóÖ ÌååÏùºÏù¥ ÏïÑÎãôÎãàÎã§.');
                    }
                } catch (err) {
                    alert('ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        function resetData() {
            if (confirm('Ï†ïÎßêÎ°ú Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌï†ÍπåÏöî?\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.')) {
                if (confirm('ÎßàÏßÄÎßâ ÌôïÏù∏ÏûÖÎãàÎã§. Ï†ïÎßê ÏÇ≠Ï†úÌï†ÍπåÏöî?')) {
                    todos = {};
                    saveTodos();
                    renderCalendar();
                    renderTodos();
                    alert('Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                }
            }
        }

        // Ï¥àÍ∏∞Ìôî
        renderCalendar();
        renderTodos();
    </script>
</body>
</html>
